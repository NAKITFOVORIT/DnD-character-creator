<!-- [file name]: gm-dashboard.html -->
<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>D&D Game Master Dashboard</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f0f0f0;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }
        
        h1, h2, h3 {
            color: #333;
        }
        
        .controls {
            margin-bottom: 20px;
            padding: 15px;
            background: #e9ecef;
            border-radius: 5px;
        }
        
        button {
            padding: 10px 15px;
            margin: 5px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            background: #007bff;
            color: white;
        }
        
        button:hover {
            background: #0056b3;
        }
        
        .characters-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(400px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .character-card {
            border: 1px solid #ddd;
            padding: 15px;
            border-radius: 5px;
            background: #f8f9fa;
            position: relative;
        }
        
        .character-card h3 {
            margin-top: 0;
            color: #495057;
            border-bottom: 2px solid #6c757d;
            padding-bottom: 5px;
        }
        
        .character-info {
            margin-bottom: 10px;
        }
        
        .stats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 5px;
            margin: 10px 0;
            background: #e9ecef;
            padding: 10px;
            border-radius: 5px;
        }
        
        .stat {
            background: #dee2e6;
            padding: 8px;
            border-radius: 3px;
            text-align: center;
            font-weight: bold;
        }
        
        .equipment-section, .abilities-section {
            margin-top: 15px;
            background: #e9ecef;
            padding: 10px;
            border-radius: 5px;
        }
        
        .equipment-section h4, .abilities-section h4 {
            margin: 0 0 10px 0;
            color: #495057;
            border-bottom: 1px solid #adb5bd;
            padding-bottom: 5px;
        }
        
        .equipment-item, .ability {
            background: #fff;
            padding: 8px;
            margin: 5px 0;
            border-radius: 3px;
            border-left: 4px solid #007bff;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .equipment-item:hover, .ability:hover {
            background: #dee2e6;
            transform: translateX(5px);
        }
        
        .item-details {
            display: none;
            background: #f8f9fa;
            padding: 10px;
            margin: 5px 0;
            border-radius: 3px;
            border: 1px solid #dee2e6;
            font-size: 0.9em;
            color: #6c757d;
        }
        
        .item-details.show {
            display: block;
            animation: fadeIn 0.3s ease;
        }
        
        .item-name {
            font-weight: bold;
            color: #495057;
            margin-bottom: 5px;
        }
        
        .item-description {
            margin-bottom: 5px;
            line-height: 1.4;
        }
        
        .item-stats {
            font-style: italic;
            color: #6c757d;
        }
        
        .character-actions {
            margin-top: 15px;
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        
        .btn-delete {
            background: #dc3545;
        }
        
        .btn-delete:hover {
            background: #c82333;
        }
        
        .btn-view {
            background: #28a745;
        }
        
        .btn-view:hover {
            background: #218838;
        }
        
        .btn-details {
            background: #6c757d;
        }
        
        .btn-details:hover {
            background: #5a6268;
        }
        
        .empty-state {
            text-align: center;
            padding: 40px;
            color: #6c757d;
            display: none;
        }
        
        .empty-state i {
            font-size: 3em;
            margin-bottom: 15px;
            opacity: 0.5;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .search-box {
            margin: 15px 0;
            padding: 10px;
            width: 100%;
            border: 1px solid #ced4da;
            border-radius: 5px;
            font-size: 16px;
        }
        
        .filters {
            display: flex;
            gap: 10px;
            margin: 10px 0;
            flex-wrap: wrap;
        }
        
        .filter-btn {
            background: #6c757d;
            padding: 5px 10px;
            font-size: 14px;
        }
        
        .filter-btn.active {
            background: #007bff;
        }
        
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }
        
        .modal-content {
            background: white;
            padding: 20px;
            border-radius: 10px;
            max-width: 80%;
            max-height: 80%;
            overflow: auto;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üé≤ D&D Game Master Dashboard</h1>
        
        <div class="controls">
            <h2>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞–º–∏</h2>
            <button onclick="importCharacter()">üì• –ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–µ—Ä—Å–æ–Ω–∞–∂–∞</button>
            <button onclick="clearAll()">üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ—Ö</button>
            <button onclick="exportCampaign()">üì§ –≠–∫—Å–ø–æ—Ä—Ç –∫–∞–º–ø–∞–Ω–∏–∏</button>
            <button onclick="importCampaign()">üì• –ò–º–ø–æ—Ä—Ç –∫–∞–º–ø–∞–Ω–∏–∏</button>
            
            <input type="text" id="search" class="search-box" placeholder="üîç –ü–æ–∏—Å–∫ –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–π..." oninput="filterCharacters()">
            
            
        </div>
        
        <div id="characters-container" class="characters-grid">
            <!-- –ü–µ—Ä—Å–æ–Ω–∞–∂–∏ –±—É–¥—É—Ç –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è –∑–¥–µ—Å—å -->
        </div>
        
        <div id="empty-state" class="empty-state">
            <div>üìù</div>
            <h3>–ù–µ—Ç –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–π</h3>
            <p>–ò–º–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–π —Å –ø–æ–º–æ—â—å—é –∫–Ω–æ–ø–∫–∏ –≤—ã—à–µ</p>
        </div>
    </div>

    <div id="modal" class="modal">
        <div class="modal-content">
            <h3 id="modal-title">–î–µ—Ç–∞–ª–∏ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞</h3>
            <pre id="modal-content" style="font-size: 12px; line-height: 1.4;"></pre>
            <button onclick="closeModal()" style="margin-top: 15px;">–ó–∞–∫—Ä—ã—Ç—å</button>
        </div>
    </div>

    <script>
        let characters = [];
        let currentFilter = 'all';
        
        // –ó–∞–≥—Ä—É–∑–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã—Ö –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–π –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ
        function loadSavedCharacters() {
            const saved = localStorage.getItem('gmCharacters');
            if (saved) {
                try {
                    characters = JSON.parse(saved);
                    renderCharacters();
                } catch (error) {
                    console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–π:', error);
                    showEmptyState();
                }
            } else {
                showEmptyState();
            }
        }
        
        // –ü–æ–∫–∞–∑–∞—Ç—å –ø—É—Å—Ç–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
        function showEmptyState() {
            const emptyState = document.getElementById('empty-state');
            const container = document.getElementById('characters-container');
            
            if (emptyState) emptyState.style.display = 'block';
            if (container) container.innerHTML = '';
        }
        
        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–π
        function saveCharacters() {
            localStorage.setItem('gmCharacters', JSON.stringify(characters));
        }
        
        // –ò–º–ø–æ—Ä—Ç –ø–µ—Ä—Å–æ–Ω–∞–∂–∞
        function importCharacter() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = '.json';
            
            input.addEventListener('change', function(event) {
                const file = event.target.files[0];
                if (!file) return;
                
                const reader = new FileReader();
                reader.onload = function(e) {
                    try {
                        const characterData = JSON.parse(e.target.result);
                        characters.push(characterData);
                        saveCharacters();
                        renderCharacters();
                        alert('–ü–µ—Ä—Å–æ–Ω–∞–∂ —É—Å–ø–µ—à–Ω–æ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω!');
                    } catch (error) {
                        alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ –∏–º–ø–æ—Ä—Ç–µ: ' + error.message);
                    }
                };
                reader.readAsText(file);
            });
            
            input.click();
        }
        
        // –û—á–∏—Å—Ç–∫–∞ –≤—Å–µ—Ö –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–π
        function clearAll() {
            if (confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å –≤—Å–µ—Ö –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–π?')) {
                characters = [];
                saveCharacters();
                renderCharacters();
            }
        }
        
        // –≠–∫—Å–ø–æ—Ä—Ç –≤—Å–µ–π –∫–∞–º–ø–∞–Ω–∏–∏
        function exportCampaign() {
            const campaignData = {
                version: "1.0",
                exported: new Date().toISOString(),
                characters: characters
            };
            
            const jsonString = JSON.stringify(campaignData, null, 2);
            const blob = new Blob([jsonString], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            
            const a = document.createElement('a');
            a.href = url;
            a.download = 'dnd_campaign_export.json';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }
        
        // –ò–º–ø–æ—Ä—Ç –∫–∞–º–ø–∞–Ω–∏–∏
        function importCampaign() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = '.json';
            
            input.addEventListener('change', function(event) {
                const file = event.target.files[0];
                if (!file) return;
                
                const reader = new FileReader();
                reader.onload = function(e) {
                    try {
                        const campaignData = JSON.parse(e.target.result);
                        characters = campaignData.characters || [];
                        saveCharacters();
                        renderCharacters();
                        alert('–ö–∞–º–ø–∞–Ω–∏—è —É—Å–ø–µ—à–Ω–æ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–∞!');
                    } catch (error) {
                        alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ –∏–º–ø–æ—Ä—Ç–µ –∫–∞–º–ø–∞–Ω–∏–∏: ' + error.message);
                    }
                };
                reader.readAsText(file);
            });
            
            input.click();
        }
        
        // –£–¥–∞–ª–µ–Ω–∏–µ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞
        function deleteCharacter(index) {
            if (confirm('–£–¥–∞–ª–∏—Ç—å —ç—Ç–æ–≥–æ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞?')) {
                characters.splice(index, 1);
                saveCharacters();
                renderCharacters();
            }
        }
        
        // –ü–æ–∫–∞–∑–∞—Ç—å/—Å–∫—Ä—ã—Ç—å –¥–µ—Ç–∞–ª–∏ –ø—Ä–µ–¥–º–µ—Ç–∞
        function toggleItemDetails(itemId) {
            const details = document.getElementById(itemId);
            if (details) {
                details.classList.toggle('show');
            }
        }
        
        // –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–π
        function filterCharacters() {
            const searchInput = document.getElementById('search');
            const searchTerm = searchInput ? searchInput.value.toLowerCase() : '';
            renderCharacters(searchTerm);
        }
        
        function filterByClass(className) {
            currentFilter = className;
            const buttons = document.querySelectorAll('.filter-btn');
            if (buttons) {
                buttons.forEach(btn => btn.classList.remove('active'));
                event.target.classList.add('active');
            }
            renderCharacters();
        }
        
        // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–π
        function renderCharacters(searchTerm = '') {
            const container = document.getElementById('characters-container');
            const emptyState = document.getElementById('empty-state');
            
            if (!container || !emptyState) return;
            
            if (characters.length === 0) {
                emptyState.style.display = 'block';
                container.innerHTML = '';
                return;
            }
            
            emptyState.style.display = 'none';
            container.innerHTML = '';
            
            const filteredCharacters = characters.filter((char, index) => {
                if (!char.basicInfo) return false;
                
                const matchesSearch = char.basicInfo.name && char.basicInfo.name.toLowerCase().includes(searchTerm) ||
                                   char.basicInfo.race && char.basicInfo.race.toLowerCase().includes(searchTerm) ||
                                   char.basicInfo.class && char.basicInfo.class.toLowerCase().includes(searchTerm);
                
                const matchesClass = currentFilter === 'all' || 
                                  (char.basicInfo.class && char.basicInfo.class.toLowerCase().includes(currentFilter.toLowerCase()));
                
                return matchesSearch && matchesClass;
            });
            
            if (filteredCharacters.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <div>üîç</div>
                        <h3>–ü–µ—Ä—Å–æ–Ω–∞–∂–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</h3>
                        <p>–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ–∏—Å–∫–∞</p>
                    </div>
                `;
                return;
            }
            
            filteredCharacters.forEach((char, index) => {
                const originalIndex = characters.findIndex(c => c.basicInfo && c.basicInfo.name === char.basicInfo.name);
                const modifiers = char.modifiers || calculateModifiers(char.stats || {});
                
                const card = document.createElement('div');
                card.className = 'character-card';
                
                // –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ HTML
                let html = `
                    <h3>${char.basicInfo?.name || '–ë–µ–∑—ã–º—è–Ω–Ω—ã–π'}</h3>
                    <div class="character-info">
                        <strong>${char.basicInfo?.race || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ'} ${char.basicInfo?.class || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ'}</strong> ‚Ä¢ –£—Ä. ${char.basicInfo?.level || 1}
                        ${char.basicInfo?.description ? `<p><em>${char.basicInfo.description.substring(0, 100)}...</em></p>` : ''}
                    </div>
                `;
                
                // –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
                if (char.stats) {
                    html += `
                        <div class="stats">
                            <div class="stat" title="–°–∏–ª–∞">–°–∏–ª–∞üí™ ${char.stats.strength || 10} (${(modifiers.strength >= 0 ? '+' : '') + (modifiers.strength || 0)})</div>
                            <div class="stat" title="–õ–æ–≤–∫–æ—Å—Ç—å">–õ–æ–≤–∫–æ—Å—Ç—åüèπ ${char.stats.dexterity || 10} (${(modifiers.dexterity >= 0 ? '+' : '') + (modifiers.dexterity || 0)})</div>
                            <div class="stat" title="–¢–µ–ª–æ—Å–ª–æ–∂–µ–Ω–∏–µ">–¢–µ–ª–æ—Å–ª–æ–∂–µ–Ω–∏–µ‚ù§Ô∏è ${char.stats.constitution || 10} (${(modifiers.constitution >= 0 ? '+' : '') + (modifiers.constitution || 0)})</div>
                            <div class="stat" title="–ò–Ω—Ç–µ–ª–ª–µ–∫—Ç">–ò–Ω—Ç–µ–ª–ª–µ–∫—Çüìö ${char.stats.intelligence || 10} (${(modifiers.intelligence >= 0 ? '+' : '') + (modifiers.intelligence || 0)})</div>
                            <div class="stat" title="–ú—É–¥—Ä–æ—Å—Ç—å">–ú—É–¥—Ä–æ—Å—Ç—åüëÅÔ∏è ${char.stats.wisdom || 10} (${(modifiers.wisdom >= 0 ? '+' : '') + (modifiers.wisdom || 0)})</div>
                            <div class="stat" title="–•–∞—Ä–∏–∑–º–∞">–•–∞—Ä–∏–∑–º–∞‚ú® ${char.stats.charisma || 10} (${(modifiers.charisma >= 0 ? '+' : '') + (modifiers.charisma || 0)})</div>
                        </div>
                    `;
                }
                
                // –°–Ω–∞—Ä—è–∂–µ–Ω–∏–µ
                if (char.equipment && (char.equipment.armor || char.equipment.weapons?.length > 0 || char.equipment.accessories?.length > 0)) {
                    html += `<div class="equipment-section"><h4>üéí –°–Ω–∞—Ä—è–∂–µ–Ω–∏–µ</h4>`;
                    
                    if (char.equipment.armor) {
                        html += `
                            <div class="equipment-item" onclick="toggleItemDetails('armor-${originalIndex}')">
                                <div class="item-name">üõ°Ô∏è ${char.equipment.armor.name || '–ë—Ä–æ–Ω—è'}</div>
                                <div class="item-details" id="armor-${originalIndex}">
                                    <div class="item-description">${char.equipment.armor.description || '–û–ø–∏—Å–∞–Ω–∏–µ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç'}</div>
                                    <div class="item-stats">${char.equipment.armor.stats || ''}</div>
                                </div>
                            </div>
                        `;
                    }
                    
                    if (char.equipment.weapons) {
                        char.equipment.weapons.forEach((weapon, weaponIndex) => {
                            html += `
                                <div class="equipment-item" onclick="toggleItemDetails('weapon-${originalIndex}-${weaponIndex}')">
                                    <div class="item-name">‚öîÔ∏è ${weapon.name || '–û—Ä—É–∂–∏–µ'}</div>
                                    <div class="item-details" id="weapon-${originalIndex}-${weaponIndex}">
                                        <div class="item-description">${weapon.description || '–û–ø–∏—Å–∞–Ω–∏–µ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç'}</div>
                                        <div class="item-stats">${weapon.stats || ''}</div>
                                    </div>
                                </div>
                            `;
                        });
                    }
                    
                    if (char.equipment.accessories) {
                        char.equipment.accessories.forEach((accessory, accIndex) => {
                            html += `
                                <div class="equipment-item" onclick="toggleItemDetails('accessory-${originalIndex}-${accIndex}')">
                                    <div class="item-name">‚ú® ${accessory.name || '–ü—Ä–µ–¥–º–µ—Ç'}</div>
                                    <div class="item-details" id="accessory-${originalIndex}-${accIndex}">
                                        <div class="item-description">${accessory.description || '–û–ø–∏—Å–∞–Ω–∏–µ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç'}</div>
                                        <div class="item-stats">${accessory.stats || ''}</div>
                                    </div>
                                </div>
                            `;
                        });
                    }
                    
                    html += `</div>`;
                }
                
                // –°–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏
                if (char.abilities && char.abilities.length > 0) {
                    html += `<div class="abilities-section"><h4>üåü –°–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏</h4>`;
                    
                    char.abilities.forEach((ability, abilityIndex) => {
                        html += `
                            <div class="ability" onclick="toggleItemDetails('ability-${originalIndex}-${abilityIndex}')">
                                <div class="item-name">üîÆ ${ability.name || '–°–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å'}</div>
                                <div class="item-details" id="ability-${originalIndex}-${abilityIndex}">
                                    <div class="item-description">${ability.description || '–û–ø–∏—Å–∞–Ω–∏–µ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç'}</div>
                                    ${ability.stats ? `<div class="item-stats">${ability.stats}</div>` : ''}
                                </div>
                            </div>
                        `;
                    });
                    
                    html += `</div>`;
                }
                
                // –ö–Ω–æ–ø–∫–∏ –¥–µ–π—Å—Ç–≤–∏–π
                html += `
                    <div class="character-actions">
                        <button class="btn-delete" onclick="deleteCharacter(${originalIndex})">üóëÔ∏è –£–¥–∞–ª–∏—Ç—å</button>
                        <button class="btn-view" onclick="viewCharacter(${originalIndex})">üìã –ü–æ–¥—Ä–æ–±–Ω–µ–µ</button>
                    </div>
                `;
                
                card.innerHTML = html;
                container.appendChild(card);
            });
        }
        
        // –ü—Ä–æ—Å–º–æ—Ç—Ä –¥–µ—Ç–∞–ª–µ–π –ø–µ—Ä—Å–æ–Ω–∞–∂–∞
        function viewCharacter(index) {
            const char = characters[index];
            const modal = document.getElementById('modal');
            const modalTitle = document.getElementById('modal-title');
            const modalContent = document.getElementById('modal-content');
            
            if (modal && modalTitle && modalContent) {
                modalTitle.textContent = `–î–µ—Ç–∞–ª–∏ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞: ${char.basicInfo?.name || '–ë–µ–∑—ã–º—è–Ω–Ω—ã–π'}`;
                modalContent.textContent = JSON.stringify(char, null, 2);
                modal.style.display = 'flex';
            }
        }
        
        // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞
        function closeModal() {
            const modal = document.getElementById('modal');
            if (modal) {
                modal.style.display = 'none';
            }
        }
        
        // –†–∞—Å—á–µ—Ç –º–æ–¥–∏—Ñ–∏–∫–∞—Ç–æ—Ä–æ–≤
        function calculateModifiers(stats) {
            const modifiers = {};
            if (stats) {
                Object.keys(stats).forEach(stat => {
                    modifiers[stat] = Math.floor(((stats[stat] || 10) - 10) / 2);
                });
            }
            return modifiers;
        }
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        document.addEventListener('DOMContentLoaded', function() {
            loadSavedCharacters();
            
            // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –ø–æ –∫–ª–∏–∫—É –≤–Ω–µ –æ–±–ª–∞—Å—Ç–∏
            const modal = document.getElementById('modal');
            if (modal) {
                modal.addEventListener('click', function(event) {
                    if (event.target === modal) {
                        closeModal();
                    }
                });
            }
            
            // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –ø–æ ESC
            document.addEventListener('keydown', function(event) {
                if (event.key === 'Escape') {
                    closeModal();
                }
            });
        });
    </script>
</body>
</html>